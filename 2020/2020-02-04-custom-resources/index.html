<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.19.12"/><style data-styled="" data-styled-version="5.0.0">.dtlUne{position:relative;text-align:left;margin:1em 0;padding:0.5em;overflow-x:auto;border-radius:3px;font-family:'Courier New',Courier,monospace;}
.dtlUne .token-lline{line-height:1.3em;height:1.3em;}
data-styled.g1[id="Code__Pre-qgjj2j-0"]{content:"dtlUne,"}
.kalapB{display:inline-block;width:2em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;}
data-styled.g2[id="Code__LineNo-qgjj2j-1"]{content:"kalapB,"}
.hHISGz{position:absolute;right:0.25rem;border:0;border-radius:3px;margin:0.25em;opacity:0.3;}
.hHISGz:hover{opacity:1;}
data-styled.g3[id="Code__CopyCode-qgjj2j-2"]{content:"hHISGz,"}
.hTEYHR{width:800px;margin:0 auto;}
data-styled.g4[id="Layout__AppStyles-ofllyx-0"]{content:"hTEYHR,"}
</style><link as="script" rel="preload" href="/techblog/webpack-runtime-32416f10351aa1627f16.js"/><link as="script" rel="preload" href="/techblog/commons-487d38bec414ba5177c2.js"/><link as="script" rel="preload" href="/techblog/app-dcbd940231e6cb5a8245.js"/><link as="script" rel="preload" href="/techblog/component---src-templates-blog-post-template-js-595d0789709c8fe06980.js"/><link as="fetch" rel="preload" href="/techblog/page-data/2020/2020-02-04-custom-resources/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><main class="Layout__AppStyles-ofllyx-0 hTEYHR"><a href="/techblog/"><h1>Technical Blog</h1><p>This is my coding blog where I write about my cloud journey.</p></a><h1>Cloudformation custom resources taking hours to timeout</h1><p>2020 February 4th</p><p>I have spent ages during development waiting for cloudformation stacks to timeout because my code has errored,
and so a response is never sent.  Very often I create a whole new stack with the serverless framework.</p><h3>What is a custom resource?</h3><p>In a CloudFormation template, you use the AWS::CloudFormation::CustomResource or Custom::String resource type to
specify custom resources.</p><p>Custom resources provide a way for you to write custom provisioning logic in CloudFormation template and
have CloudFormation run it during a stack operation, such as when you create, update or delete a stack.
For more information,
see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html">Custom Resources</a>.</p><h3>Watchdogs</h3><blockquote><p>A watchdog timer (sometimes called a computer operating properly or COP timer, or simply a watchdog) is an electronic timer
that is used to detect and recover from computer malfunctions. During normal operation, the computer regularly resets the
atchdog timer to prevent it from elapsing, or &quot;timing out&quot;. If, due to a hardware fault or program error, the computer
fails to reset the watchdog, the timer will elapse and generate a timeout signal. The timeout signal is used to
initiate corrective action or actions. The corrective actions typically include placing the computer system in a safe state
and restoring normal system operation.</p><blockquote><p><a href="https://en.wikipedia.org/wiki/Watchdog_timer">https://en.wikipedia.org/wiki/Watchdog_timer</a></p></blockquote></blockquote><h3>When to timeout?</h3><p>Within a Lambda&#x27;s context you have access to context.getRemainingTimeInMillis(), which returns the number of milliseconds left before
the execution times out.  This is great because we can timeout and send a response to AWS Cloudformation before the execution timeout.</p><h4>Example Function</h4><pre class="Code__Pre-qgjj2j-0 dtlUne prism-code language-js" style="color:#d6deeb;background-color:#011627"><button class="Code__CopyCode-qgjj2j-2 hHISGz">Copy</button><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">1</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;use strict&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> response </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;cfn-response-promise&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">3</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">4</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">handler</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">5</span><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// Install watchdog timer as the first thing</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">6</span><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">setupWatchdogTimer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">7</span><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;REQUEST RECEIVED:\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">JSON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">stringify</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">8</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">RequestType</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Create&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">9</span><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;CREATE!&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">10</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// Put your custom create logic here</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">11</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">SUCCESS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Message&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Resource creation successful!&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">12</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">13</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">RequestType</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Update&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">14</span><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;UDPATE!&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">15</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// Put your custom update logic here</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">16</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">SUCCESS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Message&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Resource update successful!&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">17</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">18</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">RequestType</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Delete&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">19</span><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;DELETE!&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">20</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// Put your custom delete logic here</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">21</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">SUCCESS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Message&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Resource deletion successful!&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">22</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">23</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">24</span><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;FAILED!&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">25</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">FAILED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">26</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">27</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">SUCCESS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">28</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">29</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">30</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">31</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">setupWatchdogTimer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">32</span><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">timeoutHandler</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">33</span><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Timeout FAILURE!&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">34</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// Emit event to &#x27;sendResponse&#x27;, then callback with an error from this</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">35</span><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// function</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">36</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">SUCCESS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> returnData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">37</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">38</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">39</span><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// Set timer so it triggers one second before this function would timeout</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">40</span><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">setTimeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">timeoutHandler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getRemainingTimeInMillis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">41</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">42</span><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="Code__LineNo-qgjj2j-1 kalapB">43</span><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">handler</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> handler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></pre><a href="/techblog/2020/2020-02-02-deploying-a-blog-site/"><p>Deploying a tech blog site</p></a></main></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2020/2020-02-04-custom-resources/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-dcbd940231e6cb5a8245.js"],"component---src-templates-blog-post-template-js":["/component---src-templates-blog-post-template-js-595d0789709c8fe06980.js"],"component---src-pages-index-js":["/component---src-pages-index-js-b1f715f6ec8816250040.js"]};/*]]>*/</script><script src="/techblog/component---src-templates-blog-post-template-js-595d0789709c8fe06980.js" async=""></script><script src="/techblog/app-dcbd940231e6cb5a8245.js" async=""></script><script src="/techblog/commons-487d38bec414ba5177c2.js" async=""></script><script src="/techblog/webpack-runtime-32416f10351aa1627f16.js" async=""></script></body></html>